<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>二手车交易价格预测之EDA</title>
    <url>//blog/2020/03/24/Used-Cars-Price-Predition-EDA/</url>
    <content><![CDATA[<p>写在前面：</p>
<p>本文主要通过探索《零基础入门数据挖掘 - 二手车交易价格预测》<a href="https://tianchi.aliyun.com/competition/entrance/231784/introduction?spm=5176.12281957.1004.1.38b02448ausjSX" target="_blank" rel="noopener">比赛数据</a>，以实践的方式复盘探索性数据分析的各项主要操作。</p>
<h2 id="font-color-chocolate什么是-eda-以及为什么-edafont"><a class="markdownIt-Anchor" href="#font-color-chocolate什么是-eda-以及为什么-edafont"></a> <font color = 'chocolate'>什么是 EDA ，以及为什么 EDA</font></h2>
<p>EDA (Exploratory Data Analysis, 即探索性数据分析) 可以帮助我们实现以下目的：</p>
<ul>
<li>更好的理解数据</li>
<li>建立对数据的直观印象</li>
<li>产生假设</li>
<li>寻找分析灵感</li>
</ul>
<p>不管是参加数据挖掘比赛，还是在实际工作中开展数据分析都离不开 EDA。在进一步展开操作之前，我们首先要了解数据背后可能代表的实际意义。尽可能全方位建立分析对象数据的直观印象。通过逐步深入了解数据的分布规律来产生假设，这一步将和数据分析这项工作的目的紧密结合在一起。最后，前面获取的这些信息将会帮助我们更好的选用合适的模型来进行训练，得到预测结果。</p>
<a id="more"></a>
<h2 id="font-color-chocolate如何-edafont"><a class="markdownIt-Anchor" href="#font-color-chocolate如何-edafont"></a> <font color = 'chocolate'>如何 EDA</font></h2>
<h3 id="font-color-chocolate工具font"><a class="markdownIt-Anchor" href="#font-color-chocolate工具font"></a> <font color = 'chocolate'>工具</font></h3>
<p>绝大多数数据科学家都采用 R 或者 Python 来完成他们的工作。本文主要采用 Python 语言来解决。需要用到的主力库如下：</p>
<ol>
<li>
<p>数值计算与统计</p>
<ul>
<li>numpy、pandas、scipy</li>
</ul>
</li>
<li>
<p>可视化</p>
<ul>
<li>matplotlib、seaborn</li>
</ul>
</li>
</ol>
<h3 id="font-color-chocolate分析操作font"><a class="markdownIt-Anchor" href="#font-color-chocolate分析操作font"></a> <font color = 'chocolate'>分析操作</font></h3>
<ol>
<li>导入训练集和测试集</li>
<li>预览数据 <code>.head()</code>, <code>df.tail()</code>，并打印两个数据集的 df<code>.shape</code></li>
<li>检查两数据集的数值类型，初步判断有无缺失值 <code>df.info()</code></li>
<li>数据的描述性统计 <code>df.describe()</code>， 检查每个统计量（重点：count， mean， std， min， max；std 接近或等于0的可以暂时忽略了, min=0 或 max=9999 要想想是否合理）</li>
<li>统计每列缺失值数量、占比</li>
<li>分析预测值的分布，检查离群点。若与正态分布相差太远可考虑进行转换 <code>np.log1p(y)</code>, <code>y^0.5</code>, <code>y^0.33</code> 等等</li>
<li>对每列的数据类型进行必要的转换（如：日期类型，文本类型等）</li>
<li>数字特征分析
<ul>
<li>相关系数 <code>df.corr()</code>, <code>sns.heatmap()</code></li>
<li>数据分布 <code>plt.hist()</code>, <code>sns.displot()</code></li>
<li>偏度和峰度（相对于标准高斯分布而言）<code>df.skew()</code>, <code>df.kurt()</code></li>
<li>特征之间的相互关系 <code>sns.pairplot()</code>, <code>sns.regplot()</code></li>
</ul>
</li>
<li>类型特征分析
<ul>
<li>unique 分布 <code>.unique</code>, <code>df.nunique()</code></li>
<li>箱形图可视化 <code>sns.boxplot()</code></li>
<li>小提琴图可视化 <code>sns.volinplot()</code></li>
<li>柱形图可视化 <code>sns.barplot()</code></li>
<li>每个类别频数可视化(count_plot) <code>sns.countplot()</code></li>
</ul>
</li>
</ol>
<h3 id="font-color-chocolate开始分析font"><a class="markdownIt-Anchor" href="#font-color-chocolate开始分析font"></a> <font color = 'chocolate'>开始分析</font></h3>
<h4 id="font-color-chocolate导入相关的库font"><a class="markdownIt-Anchor" href="#font-color-chocolate导入相关的库font"></a> <font color = 'chocolate'>导入相关的库</font></h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line">pd.set_option(&#39;display.max_columns&#39;, None) # 避免输出表格中间的列被折叠</span><br><span class="line"></span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import seaborn as sns</span><br><span class="line"></span><br><span class="line">import warnings</span><br><span class="line">warnings.filterwarnings(&#39;ignore&#39;)</span><br></pre></td></tr></table></figure>
<h4 id="font-color-chocolate1-导入训练集和测试集font"><a class="markdownIt-Anchor" href="#font-color-chocolate1-导入训练集和测试集font"></a> <font color = 'chocolate'>1. 导入训练集和测试集</font></h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">## 1) 载入训练集和测试集；</span><br><span class="line">path &#x3D; &#39;.&#x2F;datalab&#x2F;231784&#x2F;&#39;</span><br><span class="line">Train_data &#x3D; pd.read_csv(path+&#39;used_car_train_20200313.csv&#39;, sep&#x3D;&#39; &#39;)</span><br><span class="line">Test_data &#x3D; pd.read_csv(path+&#39;used_car_testA_20200313.csv&#39;, sep&#x3D;&#39; &#39;)</span><br><span class="line"># 打印 .shape</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(150000, 31) </span><br><span class="line"> (50000, 30)</span><br></pre></td></tr></table></figure>
<h4 id="font-color-chocolate2-预览数据font"><a class="markdownIt-Anchor" href="#font-color-chocolate2-预览数据font"></a> <font color = 'chocolate'>2. 预览数据</font></h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Train_data.head(3).append(Train_data.tail(3))</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">SaleID</th>
<th style="text-align:right">name</th>
<th style="text-align:right">regDate</th>
<th style="text-align:right">model</th>
<th style="text-align:right">brand</th>
<th style="text-align:right">bodyType</th>
<th style="text-align:right">fuelType</th>
<th style="text-align:right">gearbox</th>
<th style="text-align:right">power</th>
<th style="text-align:right">kilometer</th>
<th style="text-align:right">…</th>
<th style="text-align:right">v_5</th>
<th style="text-align:right">v_6</th>
<th style="text-align:right">v_7</th>
<th style="text-align:right">v_8</th>
<th style="text-align:right">v_9</th>
<th style="text-align:right">v_10</th>
<th style="text-align:right">v_11</th>
<th style="text-align:right">v_12</th>
<th style="text-align:right">v_13</th>
<th style="text-align:right">v_14</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">736</td>
<td style="text-align:right">20040402</td>
<td style="text-align:right">30.0</td>
<td style="text-align:right">6</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">60</td>
<td style="text-align:right">12.5</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.235676</td>
<td style="text-align:right">0.101988</td>
<td style="text-align:right">0.129549</td>
<td style="text-align:right">0.022816</td>
<td style="text-align:right">0.097462</td>
<td style="text-align:right">-2.881803</td>
<td style="text-align:right">2.804097</td>
<td style="text-align:right">-2.420821</td>
<td style="text-align:right">0.795292</td>
<td style="text-align:right">0.914762</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2262</td>
<td style="text-align:right">20030301</td>
<td style="text-align:right">40.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">15.0</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.264777</td>
<td style="text-align:right">0.121004</td>
<td style="text-align:right">0.135731</td>
<td style="text-align:right">0.026597</td>
<td style="text-align:right">0.020582</td>
<td style="text-align:right">-4.900482</td>
<td style="text-align:right">2.096338</td>
<td style="text-align:right">-1.030483</td>
<td style="text-align:right">-1.722674</td>
<td style="text-align:right">0.245522</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">14874</td>
<td style="text-align:right">20040403</td>
<td style="text-align:right">115.0</td>
<td style="text-align:right">15</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">163</td>
<td style="text-align:right">12.5</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.251410</td>
<td style="text-align:right">0.114912</td>
<td style="text-align:right">0.165147</td>
<td style="text-align:right">0.062173</td>
<td style="text-align:right">0.027075</td>
<td style="text-align:right">-4.846749</td>
<td style="text-align:right">1.803559</td>
<td style="text-align:right">1.565330</td>
<td style="text-align:right">-0.832687</td>
<td style="text-align:right">-0.229963</td>
</tr>
<tr>
<td style="text-align:right">149997</td>
<td style="text-align:right">149997</td>
<td style="text-align:right">147587</td>
<td style="text-align:right">20101003</td>
<td style="text-align:right">60.0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">90</td>
<td style="text-align:right">6.0</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.233353</td>
<td style="text-align:right">0.000705</td>
<td style="text-align:right">0.118872</td>
<td style="text-align:right">0.100118</td>
<td style="text-align:right">0.097914</td>
<td style="text-align:right">2.439812</td>
<td style="text-align:right">-1.630677</td>
<td style="text-align:right">2.290197</td>
<td style="text-align:right">1.891922</td>
<td style="text-align:right">0.414931</td>
</tr>
<tr>
<td style="text-align:right">149998</td>
<td style="text-align:right">149998</td>
<td style="text-align:right">45907</td>
<td style="text-align:right">20060312</td>
<td style="text-align:right">34.0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">3.0</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">156</td>
<td style="text-align:right">15.0</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.256369</td>
<td style="text-align:right">0.000252</td>
<td style="text-align:right">0.081479</td>
<td style="text-align:right">0.083558</td>
<td style="text-align:right">0.081498</td>
<td style="text-align:right">2.075380</td>
<td style="text-align:right">-2.633719</td>
<td style="text-align:right">1.414937</td>
<td style="text-align:right">0.431981</td>
<td style="text-align:right">-1.659014</td>
</tr>
<tr>
<td style="text-align:right">149999</td>
<td style="text-align:right">149999</td>
<td style="text-align:right">177672</td>
<td style="text-align:right">19990204</td>
<td style="text-align:right">19.0</td>
<td style="text-align:right">28</td>
<td style="text-align:right">6.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">193</td>
<td style="text-align:right">12.5</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.284475</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.040072</td>
<td style="text-align:right">0.062543</td>
<td style="text-align:right">0.025819</td>
<td style="text-align:right">1.978453</td>
<td style="text-align:right">-3.179913</td>
<td style="text-align:right">0.031724</td>
<td style="text-align:right">-1.483350</td>
<td style="text-align:right">-0.342674</td>
</tr>
</tbody>
</table>
<p>6 rows × 31 columns</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 打印列名</span><br><span class="line">Train_data.columns</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Index([&#39;SaleID&#39;, &#39;name&#39;, &#39;regDate&#39;, &#39;model&#39;, &#39;brand&#39;, &#39;bodyType&#39;, &#39;fuelType&#39;,</span><br><span class="line">       &#39;gearbox&#39;, &#39;power&#39;, &#39;kilometer&#39;, &#39;notRepairedDamage&#39;, &#39;regionCode&#39;,</span><br><span class="line">       &#39;seller&#39;, &#39;offerType&#39;, &#39;creatDate&#39;, &#39;price&#39;, &#39;v_0&#39;, &#39;v_1&#39;, &#39;v_2&#39;, &#39;v_3&#39;,</span><br><span class="line">       &#39;v_4&#39;, &#39;v_5&#39;, &#39;v_6&#39;, &#39;v_7&#39;, &#39;v_8&#39;, &#39;v_9&#39;, &#39;v_10&#39;, &#39;v_11&#39;, &#39;v_12&#39;,</span><br><span class="line">       &#39;v_13&#39;, &#39;v_14&#39;],</span><br><span class="line">      dtype&#x3D;&#39;object&#39;)</span><br></pre></td></tr></table></figure>
<p>这里贴一下特征的描述：</p>
<table>
<thead>
<tr>
<th><strong>Field</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>SaleID</td>
<td>交易ID，唯一编码</td>
</tr>
<tr>
<td>name</td>
<td>汽车交易名称，已脱敏</td>
</tr>
<tr>
<td>regDate</td>
<td>汽车注册日期，例如20160101，2016年01月01日</td>
</tr>
<tr>
<td>model</td>
<td>车型编码，已脱敏</td>
</tr>
<tr>
<td>brand</td>
<td>汽车品牌，已脱敏</td>
</tr>
<tr>
<td>bodyType</td>
<td>车身类型：豪华轿车：0，微型车：1，厢型车：2，大巴车：3，敞篷车：4，双门汽车：5，商务车：6，搅拌车：7</td>
</tr>
<tr>
<td>fuelType</td>
<td>燃油类型：汽油：0，柴油：1，液化石油气：2，天然气：3，混合动力：4，其他：5，电动：6</td>
</tr>
<tr>
<td>gearbox</td>
<td>变速箱：手动：0，自动：1</td>
</tr>
<tr>
<td>power</td>
<td>发动机功率：范围 [ 0, 600 ]</td>
</tr>
<tr>
<td>kilometer</td>
<td>汽车已行驶公里，单位万km</td>
</tr>
<tr>
<td>notRepairedDamage</td>
<td>汽车有尚未修复的损坏：是：0，否：1</td>
</tr>
<tr>
<td>regionCode</td>
<td>地区编码，已脱敏</td>
</tr>
<tr>
<td>seller</td>
<td>销售方：个体：0，非个体：1</td>
</tr>
<tr>
<td>offerType</td>
<td>报价类型：提供：0，请求：1</td>
</tr>
<tr>
<td>creatDate</td>
<td>汽车上线时间，即开始售卖时间</td>
</tr>
<tr>
<td>price</td>
<td>二手车交易价格（预测目标）</td>
</tr>
<tr>
<td>v系列特征</td>
<td>匿名特征，包含v0-14在内15个匿名特征</td>
</tr>
</tbody>
</table>
<h4 id="font-color-chocolate3-检查两数据集的数值类型font"><a class="markdownIt-Anchor" href="#font-color-chocolate3-检查两数据集的数值类型font"></a> <font color = 'chocolate'>3. 检查两数据集的数值类型</font></h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Train_data.info()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span><br><span class="line">RangeIndex: 150000 entries, 0 to 149999</span><br><span class="line">Data columns (total 31 columns):</span><br><span class="line"> #   Column             Non-Null Count   Dtype  </span><br><span class="line">---  ------             --------------   -----  </span><br><span class="line"> 0   SaleID             150000 non-null  int64  </span><br><span class="line"> 1   name               150000 non-null  int64  </span><br><span class="line"> 2   regDate            150000 non-null  int64  </span><br><span class="line"> 3   model              149999 non-null  float64</span><br><span class="line"> 4   brand              150000 non-null  int64  </span><br><span class="line"> 5   bodyType           145494 non-null  float64</span><br><span class="line"> 6   fuelType           141320 non-null  float64</span><br><span class="line"> 7   gearbox            144019 non-null  float64</span><br><span class="line"> 8   power              150000 non-null  int64  </span><br><span class="line"> 9   kilometer          150000 non-null  float64</span><br><span class="line"> 10  notRepairedDamage  150000 non-null  object </span><br><span class="line"> 11  regionCode         150000 non-null  int64  </span><br><span class="line"> 12  seller             150000 non-null  int64  </span><br><span class="line"> 13  offerType          150000 non-null  int64  </span><br><span class="line"> 14  creatDate          150000 non-null  int64  </span><br><span class="line"> 15  price              150000 non-null  int64  </span><br><span class="line"> 16  v_0                150000 non-null  float64</span><br><span class="line"> 17  v_1                150000 non-null  float64</span><br><span class="line"> 18  v_2                150000 non-null  float64</span><br><span class="line"> 19  v_3                150000 non-null  float64</span><br><span class="line"> 20  v_4                150000 non-null  float64</span><br><span class="line"> 21  v_5                150000 non-null  float64</span><br><span class="line"> 22  v_6                150000 non-null  float64</span><br><span class="line"> 23  v_7                150000 non-null  float64</span><br><span class="line"> 24  v_8                150000 non-null  float64</span><br><span class="line"> 25  v_9                150000 non-null  float64</span><br><span class="line"> 26  v_10               150000 non-null  float64</span><br><span class="line"> 27  v_11               150000 non-null  float64</span><br><span class="line"> 28  v_12               150000 non-null  float64</span><br><span class="line"> 29  v_13               150000 non-null  float64</span><br><span class="line"> 30  v_14               150000 non-null  float64</span><br><span class="line">dtypes: float64(20), int64(10), object(1)</span><br><span class="line">memory usage: 35.5+ MB</span><br></pre></td></tr></table></figure>
<ol>
<li>可以看出，除了 notRepairedDamage 列为 object 类型外，其余列都是数值类型。从上面可以看到 notRepairedDamage 列有 ‘-’ 的字符，其余为文本类型数字，应该时导致改列属性编程 object 的原因。</li>
<li>model / bodyType / fuelType / gearbox 存在缺失值。</li>
</ol>
<h4 id="font-color-chocolate4-数据的描述性统计font"><a class="markdownIt-Anchor" href="#font-color-chocolate4-数据的描述性统计font"></a> <font color = 'chocolate'>4. 数据的描述性统计</font></h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Train_data.describe()</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">SaleID</th>
<th style="text-align:right">name</th>
<th style="text-align:right">regDate</th>
<th style="text-align:right">model</th>
<th style="text-align:right">brand</th>
<th style="text-align:right">bodyType</th>
<th style="text-align:right">fuelType</th>
<th style="text-align:right">gearbox</th>
<th style="text-align:right">power</th>
<th style="text-align:right">kilometer</th>
<th style="text-align:right">…</th>
<th style="text-align:right">v_5</th>
<th style="text-align:right">v_6</th>
<th style="text-align:right">v_7</th>
<th style="text-align:right">v_8</th>
<th style="text-align:right">v_9</th>
<th style="text-align:right">v_10</th>
<th style="text-align:right">v_11</th>
<th style="text-align:right">v_12</th>
<th style="text-align:right">v_13</th>
<th style="text-align:right">v_14</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">count</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">1.500000e+05</td>
<td style="text-align:right">149999.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">145494.000000</td>
<td style="text-align:right">141320.000000</td>
<td style="text-align:right">144019.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">…</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
<td style="text-align:right">150000.000000</td>
</tr>
<tr>
<td style="text-align:right">mean</td>
<td style="text-align:right">74999.500000</td>
<td style="text-align:right">68349.172873</td>
<td style="text-align:right">2.003417e+07</td>
<td style="text-align:right">47.129021</td>
<td style="text-align:right">8.052733</td>
<td style="text-align:right">1.792369</td>
<td style="text-align:right">0.375842</td>
<td style="text-align:right">0.224943</td>
<td style="text-align:right">119.316547</td>
<td style="text-align:right">12.597160</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.248204</td>
<td style="text-align:right">0.044923</td>
<td style="text-align:right">0.124692</td>
<td style="text-align:right">0.058144</td>
<td style="text-align:right">0.061996</td>
<td style="text-align:right">-0.001000</td>
<td style="text-align:right">0.009035</td>
<td style="text-align:right">0.004813</td>
<td style="text-align:right">0.000313</td>
<td style="text-align:right">-0.000688</td>
</tr>
<tr>
<td style="text-align:right">std</td>
<td style="text-align:right">43301.414527</td>
<td style="text-align:right">61103.875095</td>
<td style="text-align:right">5.364988e+04</td>
<td style="text-align:right">49.536040</td>
<td style="text-align:right">7.864956</td>
<td style="text-align:right">1.760640</td>
<td style="text-align:right">0.548677</td>
<td style="text-align:right">0.417546</td>
<td style="text-align:right">177.168419</td>
<td style="text-align:right">3.919576</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.045804</td>
<td style="text-align:right">0.051743</td>
<td style="text-align:right">0.201410</td>
<td style="text-align:right">0.029186</td>
<td style="text-align:right">0.035692</td>
<td style="text-align:right">3.772386</td>
<td style="text-align:right">3.286071</td>
<td style="text-align:right">2.517478</td>
<td style="text-align:right">1.288988</td>
<td style="text-align:right">1.038685</td>
</tr>
<tr>
<td style="text-align:right">min</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">1.991000e+07</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.500000</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">-9.168192</td>
<td style="text-align:right">-5.558207</td>
<td style="text-align:right">-9.639552</td>
<td style="text-align:right">-4.153899</td>
<td style="text-align:right">-6.546556</td>
</tr>
<tr>
<td style="text-align:right">25%</td>
<td style="text-align:right">37499.750000</td>
<td style="text-align:right">11156.000000</td>
<td style="text-align:right">1.999091e+07</td>
<td style="text-align:right">10.000000</td>
<td style="text-align:right">1.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">75.000000</td>
<td style="text-align:right">12.500000</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.243615</td>
<td style="text-align:right">0.000038</td>
<td style="text-align:right">0.062474</td>
<td style="text-align:right">0.035334</td>
<td style="text-align:right">0.033930</td>
<td style="text-align:right">-3.722303</td>
<td style="text-align:right">-1.951543</td>
<td style="text-align:right">-1.871846</td>
<td style="text-align:right">-1.057789</td>
<td style="text-align:right">-0.437034</td>
</tr>
<tr>
<td style="text-align:right">50%</td>
<td style="text-align:right">74999.500000</td>
<td style="text-align:right">51638.000000</td>
<td style="text-align:right">2.003091e+07</td>
<td style="text-align:right">30.000000</td>
<td style="text-align:right">6.000000</td>
<td style="text-align:right">1.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">110.000000</td>
<td style="text-align:right">15.000000</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.257798</td>
<td style="text-align:right">0.000812</td>
<td style="text-align:right">0.095866</td>
<td style="text-align:right">0.057014</td>
<td style="text-align:right">0.058484</td>
<td style="text-align:right">1.624076</td>
<td style="text-align:right">-0.358053</td>
<td style="text-align:right">-0.130753</td>
<td style="text-align:right">-0.036245</td>
<td style="text-align:right">0.141246</td>
</tr>
<tr>
<td style="text-align:right">75%</td>
<td style="text-align:right">112499.250000</td>
<td style="text-align:right">118841.250000</td>
<td style="text-align:right">2.007111e+07</td>
<td style="text-align:right">66.000000</td>
<td style="text-align:right">13.000000</td>
<td style="text-align:right">3.000000</td>
<td style="text-align:right">1.000000</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">150.000000</td>
<td style="text-align:right">15.000000</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.265297</td>
<td style="text-align:right">0.102009</td>
<td style="text-align:right">0.125243</td>
<td style="text-align:right">0.079382</td>
<td style="text-align:right">0.087491</td>
<td style="text-align:right">2.844357</td>
<td style="text-align:right">1.255022</td>
<td style="text-align:right">1.776933</td>
<td style="text-align:right">0.942813</td>
<td style="text-align:right">0.680378</td>
</tr>
<tr>
<td style="text-align:right">max</td>
<td style="text-align:right">149999.000000</td>
<td style="text-align:right">196812.000000</td>
<td style="text-align:right">2.015121e+07</td>
<td style="text-align:right">247.000000</td>
<td style="text-align:right">39.000000</td>
<td style="text-align:right">7.000000</td>
<td style="text-align:right">6.000000</td>
<td style="text-align:right">1.000000</td>
<td style="text-align:right">19312.000000</td>
<td style="text-align:right">15.000000</td>
<td style="text-align:right">…</td>
<td style="text-align:right">0.291838</td>
<td style="text-align:right">0.151420</td>
<td style="text-align:right">1.404936</td>
<td style="text-align:right">0.160791</td>
<td style="text-align:right">0.222787</td>
<td style="text-align:right">12.357011</td>
<td style="text-align:right">18.819042</td>
<td style="text-align:right">13.847792</td>
<td style="text-align:right">11.147669</td>
<td style="text-align:right">8.658418</td>
</tr>
</tbody>
</table>
<p>8 rows × 30 columns</p>
<p><font color='red'>Tran_data 总体概况如下：</font></p>
<ul>
<li>SaleID 取值从 0 到 149999，纯粹的连续整数序列；</li>
<li>name 的取值也类似，像是 label encoded；</li>
<li>regdate 本来应该时8位数字的字符串，现在被当成整数了，后面需要转化成日期格式；</li>
<li>model / bodyType / fuelType	/ gearbox 都做了类型编码，model 列存在一个缺失值；</li>
<li>power 最大值比较离群，可能搅拌车或者异常值, 最小值是 0，一般来说车子都是有动力的；</li>
<li>kilometer 的中位数时15万公里，并且这也是最大值，说明二手车交易的这些车至少一半都是行驶了不低于15万公里的；</li>
<li>regionCode 也做了 label encodeing；</li>
<li>seller 只有 0 和 1 两个取值，对模型没什么用；</li>
<li>offerType 只有 一个 0 取值，对模型没什么用；</li>
<li>creatDate 本来应该时8位数字的字符串，现在被当成整数了，后面需要转化成日期格式；</li>
<li>price 均值是 5923，而中位数只有 3250，明显是被平均了，一看最大值竟然有 99999， 这对于回归预测非常不利；</li>
<li>v 系列的列是做了标准化的。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 检查唯一的 object 类型特征</span><br><span class="line">Train_data[&#39;notRepairedDamage&#39;].value_counts()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0.0    111361</span><br><span class="line">-       24324</span><br><span class="line">1.0     14315</span><br><span class="line">Name: notRepairedDamage, dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 替换 ‘-’ 为缺失值</span><br><span class="line">Train_data[&#39;notRepairedDamage&#39;].replace(&#39;-&#39;, np.nan, inplace&#x3D;True)</span><br><span class="line">Train_data[&#39;notRepairedDamage&#39;].isna().sum()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">24324</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 删除无用特征</span><br><span class="line">for col in [&#39;seller&#39;, &#39;offerType&#39;]:</span><br><span class="line">    del Train_data[col]</span><br><span class="line">    del Test_data[col]</span><br></pre></td></tr></table></figure>
<h4 id="font-color-chocolate5-统计每列缺失值数量-占比font"><a class="markdownIt-Anchor" href="#font-color-chocolate5-统计每列缺失值数量-占比font"></a> <font color = 'chocolate'>5. 统计每列缺失值数量、占比</font></h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Train_data.isna().sum().sort_values(ascending&#x3D;False)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">notRepairedDamage    24324</span><br><span class="line">fuelType              8680</span><br><span class="line">gearbox               5981</span><br><span class="line">bodyType              4506</span><br><span class="line">model                    1</span><br><span class="line">v_14                     0</span><br><span class="line">price                    0</span><br><span class="line">name                     0</span><br><span class="line">regDate                  0</span><br><span class="line">brand                    0</span><br><span class="line">power                    0</span><br><span class="line">kilometer                0</span><br><span class="line">regionCode               0</span><br><span class="line">creatDate                0</span><br><span class="line">v_0                      0</span><br><span class="line">v_13                     0</span><br><span class="line">v_1                      0</span><br><span class="line">v_2                      0</span><br><span class="line">v_3                      0</span><br><span class="line">v_4                      0</span><br><span class="line">v_5                      0</span><br><span class="line">v_6                      0</span><br><span class="line">v_7                      0</span><br><span class="line">v_8                      0</span><br><span class="line">v_9                      0</span><br><span class="line">v_10                     0</span><br><span class="line">v_11                     0</span><br><span class="line">v_12                     0</span><br><span class="line">SaleID                   0</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(Train_data.isna().sum() &#x2F; Train_data.shape[0]).sort_values(ascending&#x3D;False)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">notRepairedDamage    0.162160</span><br><span class="line">fuelType             0.057867</span><br><span class="line">gearbox              0.039873</span><br><span class="line">bodyType             0.030040</span><br><span class="line">model                0.000007</span><br><span class="line">v_14                 0.000000</span><br><span class="line">price                0.000000</span><br><span class="line">name                 0.000000</span><br><span class="line">regDate              0.000000</span><br><span class="line">brand                0.000000</span><br><span class="line">power                0.000000</span><br><span class="line">kilometer            0.000000</span><br><span class="line">regionCode           0.000000</span><br><span class="line">creatDate            0.000000</span><br><span class="line">v_0                  0.000000</span><br><span class="line">v_13                 0.000000</span><br><span class="line">v_1                  0.000000</span><br><span class="line">v_2                  0.000000</span><br><span class="line">v_3                  0.000000</span><br><span class="line">v_4                  0.000000</span><br><span class="line">v_5                  0.000000</span><br><span class="line">v_6                  0.000000</span><br><span class="line">v_7                  0.000000</span><br><span class="line">v_8                  0.000000</span><br><span class="line">v_9                  0.000000</span><br><span class="line">v_10                 0.000000</span><br><span class="line">v_11                 0.000000</span><br><span class="line">v_12                 0.000000</span><br><span class="line">SaleID               0.000000</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<h4 id="font-color-chocolate5-分析预测值的分布font"><a class="markdownIt-Anchor" href="#font-color-chocolate5-分析预测值的分布font"></a> <font color = 'chocolate'>5. 分析预测值的分布</font></h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fig, axes &#x3D; plt.subplots(1, 2, figsize&#x3D;(12, 6))</span><br><span class="line">sns.distplot(Train_data[&#39;price&#39;], ax&#x3D;axes[0])</span><br><span class="line">sns.boxplot(Train_data[&#39;price&#39;], ax&#x3D;axes[1])</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/price.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/price.png" alt="" /></p>
<p><font color='red'>预测值的分布:</font></p>
<ol>
<li>可以看出 price 的分布是右偏类型，右边带着长尾；通过箱图可以看到大量的离群点。</li>
<li>由于 price 的分布像指数型，故可以控过反向运算 np.log1p() 来获得接近正态分布的预测值。这对于建模非常重要，因为模型的基本假设是数据服从独立同分布IID(independent and identically distributed)。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">print(&quot;Skewness: %f&quot; % Train_data[&#39;price&#39;].skew())</span><br><span class="line">print(&quot;Kurtosis: %f&quot; % Train_data[&#39;price&#39;].kurt())</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Skewness: 3.346487</span><br><span class="line">Kurtosis: 18.995183</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fig, axes &#x3D; plt.subplots(1, 2, figsize&#x3D;(12, 6))</span><br><span class="line">sns.distplot(np.log1p(Train_data[&#39;price&#39;]), ax&#x3D;axes[0])</span><br><span class="line">sns.boxplot(np.log1p(Train_data[&#39;price&#39;]), ax&#x3D;axes[1])</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/price-log.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/price-log.png" alt="" /></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">print(&quot;Skewness: %f&quot; % np.log1p(Train_data[&#39;price&#39;]).skew())</span><br><span class="line">print(&quot;Kurtosis: %f&quot; % np.log1p(Train_data[&#39;price&#39;]).kurt())</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Skewness: -0.261727</span><br><span class="line">Kurtosis: -0.182127</span><br></pre></td></tr></table></figure>
<p>对 price 做 log 变换后其分布更接近正态分布了。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 对每列的数据类型进行必要的转换</span><br><span class="line">date_cols &#x3D; [&#39;regDate&#39;, &#39;creatDate&#39;]</span><br><span class="line"></span><br><span class="line">def proc_date(x):</span><br><span class="line">    month &#x3D; x[4:6]</span><br><span class="line">    if month &#x3D;&#x3D; &#39;00&#39;:</span><br><span class="line">        month &#x3D;&#39;01&#39;</span><br><span class="line">    return x[:4] + month + x[6:]</span><br><span class="line"></span><br><span class="line">for col in date_cols:</span><br><span class="line">    Train_data[col] &#x3D;  pd.to_datetime(Train_data[col].astype(str).apply(proc_date))</span><br><span class="line">    Test_data[col] &#x3D;  pd.to_datetime(Test_data[col].astype(str).apply(proc_date))</span><br><span class="line">    </span><br><span class="line">    Train_data[col + &#39;_year&#39;] &#x3D; Train_data[col].dt.year</span><br><span class="line">    Train_data[col + &#39;_month&#39;] &#x3D; Train_data[col].dt.month</span><br><span class="line">    Train_data[col + &#39;_day&#39;] &#x3D; Train_data[col].dt.day</span><br><span class="line">    Train_data[col + &#39;_dayofweek&#39;] &#x3D; Train_data[col].dt.dayofweek</span><br><span class="line">    </span><br><span class="line">    Test_data[col + &#39;_year&#39;] &#x3D; Test_data[col].dt.year</span><br><span class="line">    Test_data[col + &#39;_month&#39;] &#x3D; Test_data[col].dt.month</span><br><span class="line">    Test_data[col + &#39;_day&#39;] &#x3D; Test_data[col].dt.day</span><br><span class="line">    Test_data[col + &#39;_dayofweek&#39;] &#x3D; Test_data[col].dt.dayofweek</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Train_data.columns</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Index([&#39;SaleID&#39;, &#39;name&#39;, &#39;regDate&#39;, &#39;model&#39;, &#39;brand&#39;, &#39;bodyType&#39;, &#39;fuelType&#39;,</span><br><span class="line">       &#39;gearbox&#39;, &#39;power&#39;, &#39;kilometer&#39;, &#39;notRepairedDamage&#39;, &#39;regionCode&#39;,</span><br><span class="line">       &#39;creatDate&#39;, &#39;price&#39;, &#39;v_0&#39;, &#39;v_1&#39;, &#39;v_2&#39;, &#39;v_3&#39;, &#39;v_4&#39;, &#39;v_5&#39;, &#39;v_6&#39;,</span><br><span class="line">       &#39;v_7&#39;, &#39;v_8&#39;, &#39;v_9&#39;, &#39;v_10&#39;, &#39;v_11&#39;, &#39;v_12&#39;, &#39;v_13&#39;, &#39;v_14&#39;,</span><br><span class="line">       &#39;regDate_year&#39;, &#39;regDate_month&#39;, &#39;regDate_day&#39;, &#39;regDate_dayofweek&#39;,</span><br><span class="line">       &#39;creatDate_year&#39;, &#39;creatDate_month&#39;, &#39;creatDate_day&#39;,</span><br><span class="line">       &#39;creatDate_dayofweek&#39;],</span><br><span class="line">      dtype&#x3D;&#39;object&#39;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 将特征进行分类</span><br><span class="line">cate_cols &#x3D; [&#39;name&#39;, &#39;model&#39;, &#39;brand&#39;, &#39;bodyType&#39;, &#39;fuelType&#39;, &#39;gearbox&#39;, &#39;notRepairedDamage&#39;, &#39;regionCode&#39;]</span><br><span class="line">num_cols &#x3D; [&#39;power&#39;, &#39;kilometer&#39;] + [&#39;v_&#123;&#125;&#39;.format(i) for i in range(15)]</span><br><span class="line">date_cols &#x3D; [&#39;regDate_year&#39;, &#39;regDate_month&#39;, &#39;regDate_day&#39;, &#39;regDate_dayofweek&#39;, &#39;creatDate_month&#39;, &#39;creatDate_day&#39;, &#39;creatDate_dayofweek&#39;]</span><br><span class="line">cols &#x3D; date_cols + cate_cols + num_cols</span><br></pre></td></tr></table></figure>
<h4 id="font-color-chocolate8-数据特征分析font"><a class="markdownIt-Anchor" href="#font-color-chocolate8-数据特征分析font"></a> <font color = 'chocolate'>8. 数据特征分析</font></h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 相关系数</span><br><span class="line">corr_matrix &#x3D; Train_data[num_cols].corr()</span><br><span class="line"></span><br><span class="line">fig &#x3D; plt.figure(figsize&#x3D;(8, 6))</span><br><span class="line">sns.heatmap(corr_matrix.mask(lambda x: abs(x)&lt;.5)) # 过滤绝对值小于.5的</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/corr.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/corr.png" alt="" /></p>
<p>从图中可以看出v系列不少呈强正、负相关关系。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 每个数字特征得分布可视化</span><br><span class="line">f &#x3D; pd.melt(Train_data, value_vars&#x3D;(num_cols+[&#39;price&#39;]))</span><br><span class="line">g &#x3D; sns.FacetGrid(f, col&#x3D;&quot;variable&quot;,  col_wrap&#x3D;2, sharex&#x3D;False, sharey&#x3D;False)</span><br><span class="line">g &#x3D; g.map(sns.distplot, &quot;value&quot;)</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/displot.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/displot.png" alt="" /></p>
<p>可以看出 kilometer 是离散化了的。v 系列匿名特征的分布还比较均匀。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 数字特征的偏度和峰度可视化</span><br><span class="line">fig, axes &#x3D; plt.subplots(1, 2, figsize&#x3D;(12, 6))</span><br><span class="line">sns.distplot(Train_data[num_cols].skew(),color&#x3D;&#39;blue&#39;,axlabel &#x3D;&#39;Skewness&#39;, ax&#x3D;axes[0])</span><br><span class="line">sns.distplot(Train_data[num_cols].kurt(),color&#x3D;&#39;orange&#39;,axlabel &#x3D;&#39;Kurtness&#39;, ax&#x3D;axes[1])</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/skew+kurt.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/skew+kurt.png" alt="" /></p>
<p>从这张图可以看出，大部分数字特征的峰度和偏度都在0附近，分布还是比较均匀。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 特征之间的关系可视化</span><br><span class="line">sns.pairplot(Train_data[num_cols + [&#39;price&#39;]], diag_kind&#x3D;&#39;kde&#39;)</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/pairplot.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/pairplot.png" alt="" /></p>
<p>由图中可看出v_1 和 v_6 共线；v_3 和 v_8 强线性负相关；v_4 和 v_9/v_13 强线性正相关；v_6 和 v_10 强负相关；</p>
<h4 id="font-color-chocolate8-类别特征分析font"><a class="markdownIt-Anchor" href="#font-color-chocolate8-类别特征分析font"></a> <font color = 'chocolate'>8. 类别特征分析</font></h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># unique 分布</span><br><span class="line">Train_data[cate_cols].nunique()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name                 99662</span><br><span class="line">model                  248</span><br><span class="line">brand                   40</span><br><span class="line">bodyType                 8</span><br><span class="line">fuelType                 7</span><br><span class="line">gearbox                  2</span><br><span class="line">notRepairedDamage        2</span><br><span class="line">regionCode            7905</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 类别特征箱形图可视化</span><br><span class="line"></span><br><span class="line"># 因为 name和 regionCode的类别太稀疏了，这里我们把不稀疏的几类画一下</span><br><span class="line">categorical_features &#x3D; [&#39;model&#39;,</span><br><span class="line">                         &#39;brand&#39;,</span><br><span class="line">                         &#39;bodyType&#39;,</span><br><span class="line">                         &#39;fuelType&#39;,</span><br><span class="line">                         &#39;gearbox&#39;,</span><br><span class="line">                         &#39;notRepairedDamage&#39;]</span><br><span class="line">for c in categorical_features:</span><br><span class="line">    Train_data[c] &#x3D; Train_data[c].astype(&#39;category&#39;)</span><br><span class="line">    if Train_data[c].isnull().any():</span><br><span class="line">        Train_data[c] &#x3D; Train_data[c].cat.add_categories([&#39;MISSING&#39;])</span><br><span class="line">        Train_data[c] &#x3D; Train_data[c].fillna(&#39;MISSING&#39;)</span><br><span class="line"></span><br><span class="line">def boxplot(x, y, **kwargs):</span><br><span class="line">    sns.boxplot(x&#x3D;x, y&#x3D;y)</span><br><span class="line">    x&#x3D;plt.xticks(rotation&#x3D;90)</span><br><span class="line"></span><br><span class="line">f &#x3D; pd.melt(Train_data, id_vars&#x3D;[&#39;price&#39;], value_vars&#x3D;categorical_features)</span><br><span class="line">g &#x3D; sns.FacetGrid(f, col&#x3D;&quot;variable&quot;,  col_wrap&#x3D;2, sharex&#x3D;False, sharey&#x3D;False, size&#x3D;6)</span><br><span class="line">g &#x3D; g.map(boxplot, &quot;value&quot;, &quot;price&quot;)</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/boxplot.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/boxplot.png" alt="" /></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 类别特征的小提琴图可视化</span><br><span class="line">catg_list &#x3D; categorical_features</span><br><span class="line">target &#x3D; &#39;price&#39;</span><br><span class="line">fig &#x3D; plt.figure(figsize&#x3D;(16, 18))</span><br><span class="line">for i, catg in enumerate(catg_list):</span><br><span class="line">    fig.add_subplot(3, 2, i+1)</span><br><span class="line">    sns.violinplot(x&#x3D;catg, y&#x3D;target, data&#x3D;Train_data)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/violinplot.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/violinplot.png" alt="" /></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 类别特征的柱形图可视化</span><br><span class="line">def bar_plot(x, y, **kwargs):</span><br><span class="line">    sns.barplot(x&#x3D;x, y&#x3D;y)</span><br><span class="line">    x&#x3D;plt.xticks(rotation&#x3D;90)</span><br><span class="line"></span><br><span class="line">f &#x3D; pd.melt(Train_data, id_vars&#x3D;[&#39;price&#39;], value_vars&#x3D;categorical_features)</span><br><span class="line">g &#x3D; sns.FacetGrid(f, col&#x3D;&quot;variable&quot;,  col_wrap&#x3D;2, sharex&#x3D;False, sharey&#x3D;False, size&#x3D;6)</span><br><span class="line">g &#x3D; g.map(bar_plot, &quot;value&quot;, &quot;price&quot;)</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/barplot.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/barplot.png" alt="" /></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 类别特征的每个类别频数可视化(count_plot)</span><br><span class="line">def count_plot(x, **kwargs):</span><br><span class="line">    sns.countplot(x&#x3D;x)</span><br><span class="line">    x&#x3D;plt.xticks(rotation&#x3D;90)</span><br><span class="line"></span><br><span class="line">f &#x3D; pd.melt(Train_data,  value_vars&#x3D;categorical_features)</span><br><span class="line">g &#x3D; sns.FacetGrid(f, col&#x3D;&quot;variable&quot;,  col_wrap&#x3D;2, sharex&#x3D;False, sharey&#x3D;False, size&#x3D;6)</span><br><span class="line">g &#x3D; g.map(count_plot, &quot;value&quot;)</span><br></pre></td></tr></table></figure>
<img src="/blog/2020/03/24/Used-Cars-Price-Predition-EDA/countplot.png" class="">
<p><img src="./2020-03-24-Used-Cars-Price-Predition-EDA/countplot.png" alt="" /></p>
<p>&lt;–完–&gt;</p>
]]></content>
      <categories>
        <category>Notes</category>
        <category>Data Science</category>
      </categories>
      <tags>
        <tag>Competition</tag>
        <tag>Novice</tag>
      </tags>
  </entry>
  <entry>
    <title>机器学习的常用模型评估指标</title>
    <url>//blog/2020/03/21/Evaluating-Machine-Learning-Models/</url>
    <content><![CDATA[<h2 id="font-color-chocolate常见的机器学习问题font"><a class="markdownIt-Anchor" href="#font-color-chocolate常见的机器学习问题font"></a> <font color = 'chocolate'>常见的机器学习问题</font></h2>
<p>一般来说，许多机器学习问题可以分别归入以下几类：</p>
<ul>
<li>分类 classification</li>
<li>回归 regression</li>
<li>排序 ranking</li>
<li>聚类 clustering</li>
<li>推荐 recommendation</li>
</ul>
<p>本文主要就分类和回归这两类问题的评估指标展开叙述。</p>
<a id="more"></a>
<h2 id="font-color-chocolate分类问题的评估指标font"><a class="markdownIt-Anchor" href="#font-color-chocolate分类问题的评估指标font"></a> <font color = 'chocolate'>分类问题的评估指标</font></h2>
<p>分类问题可分为二分类、多分类。二分类指的是目标 target 只有两种类别，如（有病/没病）、（垃圾邮件/非垃圾邮件）。在实际计算中二分类通常被映射到“0” 和 “1”。多分类问题也可以转化为多个二分类问题，此时可采用 One-vs-Rest方法。</p>
<p>在展开各指标之前，有必要展示下混淆矩阵：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">p</th>
<th style="text-align:center">n</th>
<th style="text-align:center">总数</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">p’</td>
<td style="text-align:center">真阳性(TP)</td>
<td style="text-align:center">伪阳性(FP)</td>
<td style="text-align:center">P’</td>
</tr>
<tr>
<td style="text-align:center">n’</td>
<td style="text-align:center">伪阴性(FN)</td>
<td style="text-align:center">伪阳性(TN)</td>
<td style="text-align:center">N’</td>
</tr>
<tr>
<td style="text-align:center">总数</td>
<td style="text-align:center">P</td>
<td style="text-align:center">N</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>怎么理解这个矩阵呢？就拿通过血压值来检测一个人有没有高血压作为例子，存在以下4种情况：</p>
<ol>
<li>真阳性（TP）：<strong>诊断为有</strong>，<strong>实际上也有</strong>高血压。</li>
<li>伪阳性（FP）：<strong>诊断为有</strong>，<strong>实际却没有</strong>高血压。</li>
<li>真阴性（TN）：<strong>诊断为没有</strong>，<strong>实际上也没有</strong>高血压。</li>
<li>伪阴性（FN）：<strong>诊断为没有</strong>，<strong>实际却有</strong>高血压。</li>
</ol>
<p>有了混淆矩阵，下面的分类评估指标就可以很清晰计算出来了。</p>
<h3 id="font-color-chocolate准确率-精确率-召回率-f1值font"><a class="markdownIt-Anchor" href="#font-color-chocolate准确率-精确率-召回率-f1值font"></a> <font color = 'chocolate'>准确率、精确率、召回率、F1值</font></h3>
<ul>
<li>准确率（Accuracy）：正确分类的样本个数占总样本个数</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>c</mi><mi>c</mi><mi>u</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>y</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow><mrow><mi>P</mi><mo>+</mo><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Accuracy= \frac{TP+TN}{P+N}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>精确率（Precision）：预测正确的正例数据占预测为正例数据的比例</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Precision= \frac{TP}{TP+FP}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>召回率（Recall）：预测为正确的正例数据占实际为正例数据的比例</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Recall= \frac{TP}{TP+FN}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>F1 评分（F1 score）：</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mi>S</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>=</mo><mfrac><mn>2</mn><mrow><mfrac><mn>1</mn><mi>P</mi></mfrac><mo>+</mo><mfrac><mn>1</mn><mi>R</mi></mfrac></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>2</mn><mi>P</mi><mi>R</mi></mrow><mrow><mi>P</mi><mo>+</mo><mi>R</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">F_1 Score= \frac{2}{\frac{1}{P}+\frac{1}{R}}= \frac{2PR}{P+R}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.401548em;vertical-align:-1.080108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.2648919999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.080108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<div class="note info">
            <h4 id="注意"><a class="markdownIt-Anchor" href="#注意"></a> 注意！</h4><p>在正负样本比例分布不均衡时，占比大的类别会影响准确率。如异常检测中非异常点占比可能达到99%以上，此时把所有样本都视为非异常点就能获得极高的准确率。</p><p>精确率可以理解为预测出的东西有多少是用户感兴趣的，而召回率可以理解为用户感兴趣的东西有多少被预测出来了。精确率和召回率是一对矛盾的度量，为了兼顾正负样本的识别，可引入比较平衡的F1 评分。</p>
          </div>
<h3 id="font-color-chocolate可视化指标p-r-roc-aucfont"><a class="markdownIt-Anchor" href="#font-color-chocolate可视化指标p-r-roc-aucfont"></a> <font color = 'chocolate'>可视化指标：P-R、ROC、AUC</font></h3>
<ul>
<li>P-R 曲线：横轴召回率，纵轴精确率。</li>
<li>ROC（receiver operating characteristic curve接收者操作特征曲线）：采用不分类阈值时的TPR（真阳性率）与FPR（伪阳性率）围成的曲线，以FPR为横坐标，TPR为纵坐标。如果 ROC 是光滑的，那么基本可以判断没有太大的overfitting。</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mi>P</mi><mi>R</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mi>P</mi></mfrac><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">TPR = \frac{TP}{P} = \frac{TP}{TP+FN}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi>P</mi><mi>R</mi><mo>=</mo><mfrac><mrow><mi>F</mi><mi>P</mi></mrow><mi>N</mi></mfrac><mo>=</mo><mfrac><mrow><mi>F</mi><mi>P</mi></mrow><mrow><mi>F</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">FPR = \frac{FP}{N} = \frac{FP}{FP + TN}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>AUC（area under curve）：计算从（0, 0）到（1, 1）之间整个ROC曲线以下的整个二维面积，用于衡量二分类问题其机器学习算法性能的泛化能力。
<ul>
<li>AUC = 1，是完美分类器，采用这个预测模型时，存在至少一个阈值能得出完美预测。</li>
<li>0.5 &lt; AUC &lt; 1，优于随机猜测。这个分类器（模型）妥善设定阈值的话，能有预测价值。</li>
<li>AUC = 0.5，跟随机猜测一样（例：丢铜板），模型没有预测价值。</li>
<li>AUC &lt; 0.5，比随机猜测还差；但只要总是反预测而行，就优于随机猜测。</li>
</ul>
</li>
</ul>
<h2 id="font-color-chocolate回归问题的评估指标font"><a class="markdownIt-Anchor" href="#font-color-chocolate回归问题的评估指标font"></a> <font color = 'chocolate'>回归问题的评估指标</font></h2>
<h3 id="font-color-chocolatemse-rmse-mae-r2font"><a class="markdownIt-Anchor" href="#font-color-chocolatemse-rmse-mae-r2font"></a> <font color = 'chocolate'>MSE、RMSE、MAE、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">R^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></font></h3>
<ul>
<li>MSE(Mean Squared Error) 均方误差</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">MSE= \frac{1}{m}\sum_{i=1}^{m}(y_i-\hat y)^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>RMSE(Root Mean Squared Error) 均方根误差</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mi>E</mi><mo>=</mo><msqrt><mrow><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">RMSE= \sqrt{\frac{1}{m}\sum_{i=1}^{m}(y_i-\hat y)^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1568160000000005em;vertical-align:-1.277669em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8791470000000006em;"><span class="svg-align" style="top:-5.116816em;"><span class="pstrut" style="height:5.116816em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.8391470000000005em;"><span class="pstrut" style="height:5.116816em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.196816em;"><svg width='400em' height='3.196816em' viewBox='0 0 400000 3196' preserveAspectRatio='xMinYMin slice'><path d='M702 80H400000v40H742v3062l-4 4-4 4c-.667.7
-2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1h-12l-28-84c-16.667-52-96.667
-294.333-240-727l-212 -643 -85 170c-4-3.333-8.333-7.667-13 -13l-13-13l77-155
 77-156c66 199.333 139 419.667 219 661 l218 661zM702 80H400000v40H742z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>MAE(Mean Absolute Error) 平均绝对误差</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>A</mi><mi>E</mi><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">∣</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo stretchy="false">∣</mo></mrow><annotation encoding="application/x-tex">MAE= \frac{1}{m}\sum_{i=1}^{m}\lvert y_i-\hat y\rvert
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose">∣</span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">R^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>决定系数</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>S</mi><msub><mi>S</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi></mrow></msub></mrow><mrow><mi>S</mi><msub><mi>S</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><munder><mo>∑</mo><mi>i</mi></munder><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><munder><mo>∑</mo><mi>i</mi></munder><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>ˉ</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo stretchy="false">)</mo></mrow><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
R^2= 1-\frac{SS_{res}}{SS_{tot}} &amp;= 1-\frac{\sum_{i}(y_i- \hat y)^{2}}{\sum_{i}(y_i- \bar y)^{2}}\\
&amp;= 1-\frac{MSE(y,\hat y)}{Var(y)}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.452528em;vertical-align:-2.4762639999999996em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9762640000000005em;"><span style="top:-4.9762640000000005em;"><span class="pstrut" style="height:3.503818em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2635540000000005em;"><span class="pstrut" style="height:3.503818em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4762639999999996em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9762640000000005em;"><span style="top:-4.9762640000000005em;"><span class="pstrut" style="height:3.503818em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5038179999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897100000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9857100000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2635540000000005em;"><span class="pstrut" style="height:3.503818em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4762639999999996em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<div class="note info">
            <h4 id="注意"><a class="markdownIt-Anchor" href="#注意"></a> 注意！</h4><p>MSE、RMSE、MAE、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">R^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>主要用于回归模型。</p><p>MSE 和 RMSE 可以很好的反应回归模型预测值和真实值的偏离程度，但如果存在个别离群点的偏离程度非常大时，即使其数量非常少也会使得RMSE指标变差（因为用了平方）。解决这种问题主要有三个方案：</p><ol><li>如果认为是异常点时，在数据预处理的时候就把它过滤掉；</li><li>如果不是异常点的话，就提高模型的预测能力，将离群点产生的原因建模进去；</li><li>此外也可以找鲁棒性更好的评价指标，如：MAE。</li></ol>
          </div>
<p>模型评估指标还有很多，不过这次要就此打住了。其余留待下回分解吧！</p>
<p>Credit:</p>
<p><a href="https://mp.weixin.qq.com/s/qExXN0B-AzwWlS728MA41g" target="_blank" rel="noopener">阿泽, Datawhale, 一文详尽系列之模型评估指标.</a></p>
]]></content>
      <categories>
        <category>Notes</category>
      </categories>
      <tags>
        <tag>Machine Learning</tag>
        <tag>Evaluation metrics</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>//blog/2020/03/18/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<a id="more"></a>
<h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2>
<h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
  </entry>
</search>
